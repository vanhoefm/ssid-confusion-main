% Elements that got dropped:
% - Table with the properties of the network cards that we tested
% - Document in the experimental setup how we injected frames with source address equal to a the monitor interface and one not equal to the monitor interface.
%TODO: Include the anonymous tag
\documentclass[sigconf,review]{acmart}
%\settopmatter{printfolios=true}
\usepackage[inline]{enumitem}
\usepackage{xcolor}

\copyrightyear{2023}
\acmYear{2023}
\setcopyright{acmlicensed}\acmConference[WiSec '23]{Proceedings of the 16th ACM Conference on Security and Privacy in Wireless and Mobile Networks}{May 29-June 1, 2023}{Guildford, United Kingdom}
\acmBooktitle{Proceedings of the 16th ACM Conference on Security and Privacy in Wireless and Mobile Networks (WiSec '23), May 29-June 1, 2023, Guildford, United Kingdom}
\acmPrice{15.00}
\acmDOI{10.1145/3558482.3581779}
\acmISBN{978-1-4503-9859-6/23/05}

% Improved URL splitting over multiple lines:
\def\UrlBigBreaks{\do\/\do-\do:}

% ======== TikZ =========

\usepackage{tikz}
\usetikzlibrary{intersections}
\usetikzlibrary{arrows}
\usetikzlibrary[patterns]
\usetikzlibrary{calc,positioning,shapes,decorations.pathreplacing}
% By default large arrow heads, and nodes next to each other
\tikzset{>=angle 90, node distance=-\pgflinewidth}

% ======== Utility commands =========

\newcommand{\wifi}{\mbox{Wi-Fi}}
\DeclareRobustCommand{\red}[1]{\textcolor{red}{#1}}
%\newcommand{\red}[1]{#1}

\begin{document}

\title{SSID Confusion Attacks against Protected \wifi{} Networks}

\author{Héloïse Gollier}
\affiliation{%
	\institution{DistriNet, KU Leuven}
	\city{Leuven}
	\country{Belgium}
}
\email{heloise.gollier@kuleuven.be}
\orcid{0000-0000-0000-0000}

\author{Mathy Vanhoef}
\affiliation{%
	\institution{DistriNet, KU Leuven}
	\city{Leuven}
	\country{Belgium}
}
\email{Mathy.Vanhoef@kuleuven.be}
\orcid{0000-0002-8971-9470}

\renewcommand{\shortauthors}{Mathy Vanhoef, Xianjun Jiao, Wei Liu \& Ingrid Moerman}

%%
%% The code below is generated by the tool at http://dl.acm.org/ccs.cfm.
%% Please copy and paste the code instead of the example below.
%%
\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10002978.10003014.10003017</concept_id>
       <concept_desc>Security and privacy~Mobile and wireless security</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10003033.10003039.10003041.10003042</concept_id>
       <concept_desc>Networks~Protocol testing and verification</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
 </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Security and privacy~Mobile and wireless security}
\ccsdesc[300]{Networks~Protocol testing and verification}

%% Separate the keywords with commas.
\keywords{802.11, monitor mode, packet injection, radiotap}

%% A "teaser" image appears between the author and affiliation
%% information and the body of the document, and typically spans the
%% page.
% \begin{teaserfigure}
%   \includegraphics[width=\textwidth]{sampleteaser}
%   \caption{Seattle Mariners at Spring Training, 2010.}
%   \Description{Enjoying the baseball game from the third-base
%   seats. Ichiro Suzuki preparing to bat.}
%   \label{fig:teaser}
% \end{teaserfigure}

% \received{20 February 2007}
% \received[revised]{12 March 2009}
% \received[accepted]{5 June 2009}

\begin{abstract}
Write an abstract here.
\end{abstract}

\maketitle

\section{Introduction}

Hello world!

To summarize, our contributions are:
\begin{itemize}
    \item We systematically inspect all \wifi{} authentication methods and whether they authenticate the SSID (Section~X).

    \item We propose and evaluate our SSID confusion attack against home and Enterprise \wifi{} networks.
    % First constant presence, second where attacker is only present on other channel during connection => the SSID in the beacon is **NOT** checked anymore once connected!!!

	\item We study possible practical impacts of our SSID confusion attack (Section~X).
	
	\item We propose (backwards-compatible) defenses (Section~Y).
\end{itemize}
Finally, we give an overview of related work in Section~\ref{sec:relatedwork}, and we conclude in Section~\ref{sec:conclusion}.

% \vspace{0.2cm}
% \noindent
% \textbf{Coordinated disclosure.}
% We disclosed all identified vulnerabilities to the affected vendors.

\section{Background}

This section will introduce relevant authentication methods defined in the IEEE 802.11 standard that underpins \wifi{}~\cite{ieee80211-2020}.

\subsection{\red{\wifi{} Security}}

\red{Maybe talk about expectations, that the SSID really uniquely identifies the network, and users may trust their organization but not others?}

\subsection{Home and Enterprise Authentication}

Typically, we can identify two types of protected \wifi{} networks: home and Enterprise networks.
Home networks are protected by a pre-shared password that all users posses.
In contrast, Enterprise networks use the 802.1X protocol for authentication.
This enables the network to use any Extensible Authentication Protocol (EAP) it desires: authentication can be done based on a username and password, using certificates, using one-time passwords, and so on.

\subsection{Infrastructure and Mesh Networks}

Broadly speaking, a \wifi{} network can operate in \red{multiple modes}, with two of the most common ones being infrastructure and mesh mode.
In infrastructure networks, there is a single central Access Point~(AP), and all clients connect and authenticate with this AP.
%TODO: More detail. Who to authenticiate with?
\red{In contrast, in a mesh network there is no central fixed node.}

\subsection{Authentication Methods}

Overview of authentication. Mention that the certificate is verified, and/or the username and password, but never the SSID.

Contrast with home network: the SSID is verified during the handshake.
Cannot sneakily make a victim connect to a different network, even if both networks use the same password.

\section{SSID Confusion Attacks}
\label{sec:improvedinjection}

\input{table-authmethods}

\begin{itemize}
	\item For Enterprise networks, we can make the victim connect to SSID B but the user thinks it is connected to SSID A.

	\item Home networks: we can also do the same for WPA3 with the old ``hunting and pecking'' method.
	
	% https://www.mathyvanhoef.com/2015/03/codegate-2015-goodcrypto-advanced-wep.html
	\item Home networks: The SSID confusion attack would also have worked against old WEP networks.
\end{itemize}


\red{What about AP PeerKey?}

For an Enterprise network, a subsequent Fast BSS Transition would also still work, since it is not based on the SSID either.

With Mesh networks: ``In order to create a secure peering, mesh STAs first authenticate each other and create a mesh PMKSA. This can be done using either SAE or IEEE Std 802.1X. A mesh STA shall support SAE authentication (see 12.4). A mesh STA may support IEEE 802.1X authentication (see 4.10).''
That is followed by AMPE which does not verify the SSID.
So the attack is also possible for mesh networks.

Technically also the TPK handshake for client to client communication.
But what's the point, no practical impact or realistic threat model?

% https://mrncciew.com/2023/09/25/fils-fast-initial-link-setup/
FILS Public Key authentication also looks vulnerable.
Is it realistic that two networks share the same public key?

\red{
%Same password for SSID-WPA2 and different SSID-WPA3?
%Assuming password cannot be brute-forced, has the benefit that WPA3 provides forward secrecy.
%But then we can't change the SSID because the client will realize that the security configuration has changed...
What about two SSID with different requirements like Management Frame Protection?
We cite several sources where enabling MFP or similar would cause issues, so one network is basic, and the other has all the extensions.}

\subsection{Channel Validation}

\red{---TODO: What about performing the attack when channel validation is enabled? Probably just do a wormhole attack or be out of range of the original AP.---}

\section{Checking SSID in Beacon}

\subsection{Beacon Protection}

Once a client has connected, does it check the SSID in the received beacons?
If not, the attacker only needs to be present while connecting, and can then move the client back to the original channel.

\red{---Can we still perform the attack when beacon protection is being used?---}
Doesn't look like it on Linux, see mac80211/mlme.c.
Normally a reference beacon should be saved, which is then checked once connected.
This is currently not done by Linux.

\subsection{Evaluation}

We make a test tool again? So no full attack, but check all the preconditions.

\red{---Test 1: configure using ``weak'' SSID. But manually change SSID to ``strong'' one in beacon, probe response, and association response. That simulates an attack. Does the client connect?---}

\red{---Test 2: change the SSID in the beacon only after connecting. Both with and without beacon protection.---}

Our tool supports all major authentication methods: WEP, WPA2/3, WPA3 with SAE-Loop and SAE-Constant, PEAP, TTLS, EAP-PWD, and so on.
Additionally, test can be performed while the network is using \red{MFP} or \red{beacon protection}.

\subsection{Properly-Implemented Beacon Protection}

\red{Demonstrate that the attack is prevented in all cases when the AP and client use beacon protection, with reference beacon comparison, and optionally with SSID checking in received beacons.}

\section{Evaluation}
\label{sec:evaluation}

Example attack scenarios Enterprise:
\begin{itemize}
	\item Eduroam and local \wifi{} network that use the same authentication.
	Scrape eduroam and look if the radius server is also used in other configuration guides.
	\item Telenet Wi-Free and KU Leuven university login.
	Home users can now intercept traffic!
\end{itemize}

We can test these attacks at multiple devices as well.

Based on scraping of the tools, we found 6 vulnerable organizations:
eduroam.technion.ac.il
nac.temple.edu
radius.kuleuven.be
radius.vse.cz
radius.york.ac.uk
val.ul.ie

\red{---TODO: Also check for public key reuse?---}

Example attack scenarios WPA3.
Note that an attack only makes sense if the adversary does not know the password, otherwise they can just put up a rogue AP:
\begin{itemize}
	\item 
\end{itemize}

Impact of SSID confusion:
\begin{itemize}
	\item CloudFlare's 1.1.1.1: can be abused to disable a victim's VPN.
\end{itemize}

\section{\red{Public \wifi{} Networks}}

\begin{itemize}
	\item TELENET Wi-Free
	\item citiwifi in Luxembourg and \verb|luxfuturelab.lu|
\end{itemize}

\section{Defenses}

Backwards-compatible:
\begin{itemize}
	\item \textbf{\red{Properly implement beacon protection with reference beacon verification or comparison! Make it required on the client!}}
	\item Use a different RADIUS server for each network.
	\item Use a different inner/outer identity for each network?
	Depends on whether the RADIUS server knows the network the request came from.
	\item Modify the client OS to include a flag whether the authenticity of the SSID is currently verified.
	Alternatively, instead of giving access to the SSID, the OS could make available the CommonName used in enterprise networks.
\end{itemize}

Protocol changes:
\begin{itemize}
	\item The 4-way handshake itself could (again) include the SSID.
\end{itemize}

\section{Related Work}
\label{sec:relatedwork}

Related work!

\section{Conclusion}
\label{sec:conclusion}

Need to authenticate the SSID!

%\vspace{-0.05cm}
\begin{acks}
This research is partially funded by the Research Fund KU Leuven, and by the Flemish Research Programme Cybersecurity.
\end{acks}

%\vspace{-0.05cm}
\bibliographystyle{ACM-Reference-Format}
\bibliography{references}

% \appendix
% \section{Research Methods}
% \subsection{Part One}

\end{document}
\endinput